//adapted from https://www.beyond-circuits.com/wordpress/2016/03/detecting-the-rising-edge-of-a-short-pulse/

`timescale 1ns/1ns
module edge_detect
  (
   input pulse,
	input valid,
	input notvalid,
   input clk,

   output btnl_rise
   );

  reg valid_held = 0;
  reg notvalid_held = 0;
  always @(posedge clk or posedge pulse)
    if (pulse)
      valid_held <= valid;
		notvalid_held <= notvalid;
    else
      valid_held <= 0;
		notvalid_held <= 0;

  reg [1:0] btnl_shift = 0;
  always @(posedge clk)
    btnl_shift <= {btnl_shift,valid_held && !notvalid_held};
  
  assign btnl_rise = btnl_shift == 2'b01;
endmodule